<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <link rel = "icon" href = "./favicon.ico" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"
    />
    <title>충맛집 - 충대인의 밥 선택 해결</title>

    <script
      src="https://kit.fontawesome.com/b7507b22be.js"
      crossorigin="anonymous"
    ></script>
    <link
      href="./goodmenu-map/public/bootstrap4/css/bootstrap.min.css"
      rel="stylesheet"
      type="text/css"
    />
    <script
      type="text/javascript"
      src="https://openapi.map.naver.com/openapi/v3/maps.js?ncpClientId=93gqruosnz"
    ></script>

    <style>
      body {
        display: flex;
        margin: 0;
      }
      #sidebar {
        width: 4.5rem;
        height: 100vh;
        background-color: #f8f9fa;
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      #mapContainer {
        position: relative;
        width: 100%;
        height: 100vh;
        overflow: hidden;
      }

      #searchBox {
        position: absolute;
        top: 10px;
        left: 50%;
        transform: translateX(-50%);
        z-index: 1000;
        background-color: white;
        padding: 10px;
        border-radius: 5px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      }

      #map {
        width: 100%;
        height: calc(100vh - 40px);
      }

      #toggleBtn {
        width: 50px;
        height: 50px;
        background-color: lightgreen;
        border: none;
        border-radius: 50%;
        font-size: 30px;
        line-height: 40px;
        cursor: pointer;
        position: fixed;
        bottom: 10px;
        left: calc(50% - 25px);
        transition: background-color 0.3s ease, bottom 0.5s ease;
      }

      #toggleBtn:hover {
        background-color: lightyellow;
      }

      .container-column {
        width: 33.333%;
        height: 200px;
        background-color: lightblue;
        position: fixed;
        left: 0;
        transition: bottom 0.5s ease, transform 0.5s ease;
        text-align: center;
        overflow: auto;
      }

      #container1 {
        bottom: -200px;
        z-index: 999;
      }

      #container2 {
        bottom: -200px;
        left: 33.333%;
        z-index: 998;
      }

      #container3 {
        bottom: -200px;
        left: 66.666%;
        z-index: 997;
        background-color: lightyellow;
      }
      .sidenav {
        height: 100%;
        width: 0;
        position: fixed;
        z-index: 1;
        top: 0;
        left: 4.5rem; /* Adjusted to appear next to the sidebar */
        background-color: #fcedaa;
        overflow-x: hidden;
        transition: 0.5s;
        padding-top: 60px;
      }

      .sidenav a {
        padding: 8px 8px 8px 32px;
        text-decoration: none;
        font-size: 25px;
        color: #363636;
        display: block;
        transition: 0.3s;
      }

      .sidenav a:hover {
        color: #a9cfe2;
      }

      .sidenav .closebtn {
        position: absolute;
        top: 0;
        right: 25px;
        font-size: 36px;
        margin-left: 50px;
      }
      @media screen and (max-height: 450px) {
        .sidenav {
          padding-top: 15px;
        }
        .sidenav a {
          font-size: 18px;
        }
      }
    </style>
    <!-- <link href="sidebars.css" rel="stylesheet" /> -->
  </head>
  <body>
    <div class="b-example-divider b-example-vr"></div>
    <!-- ? -->
    <div
      class="d-flex flex-column flex-shrink-0 bg-body-tertiary"
      style="width: 4.5rem"
    >
      <a
        href="#"
        class="d-block p-3 link-body-emphasis text-decoration-none"
        title="CBNU"
        data-bs-toggle="tooltip"
        data-bs-placement="right"
      >
        <img
          src="https://i.imgur.com/3XbMneV.png"
          alt="Icon"
          width="50"
          height="50"
        />
        <span class="visually-hidden">Icon-only</span>
      </a>
      <ul class="nav nav-pills nav-flush flex-column mb-auto text-center">
        <li class="nav-item">
          <a
            href="/"
            class="nav-link active py-3 border-bottom rounded-0"
            aria-current="page"
            title="Home"
            data-bs-toggle="tooltip"
            data-bs-placement="right"
          >
            <i class="fa-solid fa-house fa-xl"></i>
          </a>
        </li>
        <!-- search -->
        <li>
          <a
            href="#"
            class="nav-link py-3 border-bottom rounded-0"
            title="search"
            data-bs-toggle="modal"
            data-bs-target="#searchModal"
          >
            <i class="fa-solid fa-magnifying-glass fa-lg"></i>
          </a>
        </li>
        <!--- school information --->
        <li>
          <a
            href="#"
            class="nav-link py-3 border-bottom rounded-0"
            title="Customers"
            data-bs-toggle="tooltip"
            data-bs-placement="right"
          >
            <i class="fa-solid fa-school-flag fa-lg"></i>
          </a>
        </li>
        <!-- stars -->
        <li>
          <a
            href="#"
            class="nav-link py-3 border-bottom rounded-0"
            title="Stars"
            data-bs-toggle="tooltip"
            data-bs-target="mySidenav"
            onclick="toggleNav('mySidenav')"
          >
            <i class="fa-solid fa-star fa-lg"></i>
          </a>
        </li>
        <!--- random --->
        <li>
          <a
            href="#"
            class="nav-link py-3 border-bottom rounded-0"
            title="Products"
            data-bs-toggle="tooltip"
            data-bs-placement="right"
          >
            <i class="fa-solid fa-shuffle fa-lg"></i>
          </a>
        </li>
      </ul>
    </div>
    <!-- Modal -->
    <div
      class="modal fade"
      id="searchModal"
      tabindex="-1"
      aria-labelledby="searchModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
          <div class="modal-header">
            <div class="container-fluid">
              <form class="d-flex">
                <input
                  class="form-control me-2"
                  type="search"
                  placeholder="Search"
                  aria-label="Search"
                  id = "searchInput"
                />
                <button class="btn btn-outline-success" id="searchBtn" type="button">
                  <i class="fa-solid fa-magnifying-glass fa-lg"></i>
                </button>
              </form>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- mySidenav -->
    <div id="mySidenav" class="sidenav">
      <a href="javascript:void(0)" class="closebtn" onclick="toggleNav('mySidenav')"
        >&times;</a
      >
      <a href="#">About</a>
      <a href="#">Services</a>
      <a href="#">Clients</a>
      <a href="#">Contact</a>
    </div>
    <!-- mapContainer -->
    <div id="mapContainer">
      <div id="map"></div>
    </div>
    <script>
      var mapOptions = {
        center: new naver.maps.LatLng(36.627620, 127.454883),
        zoom: 16,
      };

      var map = new naver.maps.Map("map", mapOptions);

    
      var markerImage = {
            url: 'https://navermaps.github.io/maps.js/docs/img/example/pin_default.png',
            size: new naver.maps.Size(50, 52),
            origin: new naver.maps.Point(0, 0),
            anchor: new naver.maps.Point(25, 52)
        };
    
        var markers = [];
    
        // 마커 생성 및 이벤트 처리
        function createMarker(position, title) {
            var marker = new naver.maps.Marker({
                position: position,
                map: map,
                icon: markerImage,
                title: title
            });
    
            markers.push(marker);
    
            var infowindow = new naver.maps.InfoWindow({
                content: '<div style="width:150px;text-align:center;padding:10px;">' + title + '</div>'
            });
    
            naver.maps.Event.addListener(marker, 'click', function() {
                infowindow.open(map, marker);
            });
        }
    
        // 마커 생성
        createMarker(new naver.maps.LatLng(36.624303, 127.449607), '명장국밥 개신점');
        createMarker(new naver.maps.LatLng(36.626117, 127.452091), '보통의 국수집');
        createMarker(new naver.maps.LatLng(36.625669, 127.463756), '구룡산 한식');
        createMarker(new naver.maps.LatLng(36.624039, 127.450508), '현고 들깨칼국수');
        createMarker(new naver.maps.LatLng(36.624639, 127.467022), '사나이 짬뽕');

        
        
      var storeList = document.getElementById("storeList");
      var storeDetails = document.getElementById("storeDetails");
      
      // db 주소
      fetch("http://127.0.0.1:5500/stores/")
        .then((response) => response.json())
        .then((data) => {
          console.log("Data Loaded:", data);
          data.forEach((store) => {
            let marker = new naver.maps.Marker({
              position: new naver.maps.LatLng(store.latitude, store.longitude),
              map: map,
              title: store.name,
              icon: markerImage,
            });
            markers.push(marker);

            let li = document.createElement("li");
            li.textContent = store.name;
            li.addEventListener("click", () => {
              map.setCenter(marker.getPosition());
              map.setZoom(25);
              showDetails(store);
            });
            storeList.appendChild(li);
          });
        })
        .catch((error) => {
          console.error("Error loading data:", error);
        });

      function showDetails(store) {
        storeDetails.innerHTML = `
            <h2>${store.name}</h2>
            <p>전화번호: ${store.phone}</p>
            <p>메뉴: ${store.menu}</p>
            <p>링크: <a href="${store.link}" target="_blank">${store.link}</a></p>
            <p>위도: ${store.latitude}</p>
            <p>경도: ${store.longitude}</p>
        `;
      }

      document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('searchBtn').addEventListener('click', function() {
            var searchInput = document.getElementById('searchInput').value.trim();
            var found = false;
    
            markers.forEach(marker => {
                if (marker.getTitle().includes(searchInput)) {
                    map.setCenter(marker.getPosition());
                    map.setZoom(18);
                    found = true;
                }
            });
    
            if (!found) {
                alert('해당 핀을 찾을 수 없습니다.');
            }
        });
    });
    </script>
    <script>
       let navOpen = false; // 상태 변수

function toggleNav(navId) {
    let nav = document.getElementById(navId);
    if (nav) { // nav가 null이 아닌 경우에만 동작
        if (navOpen) {
            closeNav(nav);
        } else {
            openNav(nav);
        }
        navOpen = !navOpen; // 상태 변경
    } else {
        console.error(`Element with ID ${navId} not found`);
    }
}

function openNav(nav) {
    nav.style.width = "500px"; // width 값을 500px에서 250px로 변경
}

function closeNav(nav) {
    nav.style.width = "0";
    
}
      
    </script>
    <script
      src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
      integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
      integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
<!--- document.getElementById("mapContainer").style.marginLeft = "0"; --->
